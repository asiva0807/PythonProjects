MonIntfLst=[["17:17:38.814696","d8:b1:22:eb:75:0e > ff:ff:ff:ff:ff:ff, ethertype 802.1Q (0x8100), length 46: vlan 3, p 0, ethertype ARP, arp who-has 12.3.0.1 tell 12.3.0.2","ffff ffff ffff d8b1 22eb 750e 8100 0003 0806 0001 0800 0604 0001 d8b1 22eb 750e 0c03 0002 0000 0000 0000 0c03 0001"],
["17:17:38.815534","84:18:88:15:67:c0 > d8:b1:22:eb:75:0e, ethertype 802.1Q (0x8100), length 60: vlan 3, p 0, ethertype ARP, arp reply 12.3.0.1 is-at 84:18:88:15:67:c0","d8b1 22eb 750e 8418 8815 67c0 8100 0003 0806 0001 0800 0604 0002 8418 8815 67c0 0c03 0001 d8b1 22eb 750e 0c03 0002 0000 0000 0000 0000 0000 0000 0000"],
["17:39:11.109512","d8:b1:22:eb:75:0e > 01:00:5e:00:00:05, ethertype 802.1Q (0x8100), length 98: vlan 4, p 6, ethertype IPv4, (tos 0xc0, ttl   1, id 42879, offset 0, flags [none], proto: OSPF (89), length: 80) 12.4.0.2 > 224.0.0.5: OSPFv2, Hello, length 60 [len 48]"," 0100 5e00 0005 d8b1 22eb 750e 8100 c004 0800 45c0 0050 a77f 0000 0159 250b 0c04 0002 e000 0005 0201 0030 6804 0404 0000 0000 0408 0000 0000 0000 0000 0000 ffff ff00 000a 1280 0000 0028 0c04 0002 0c04 0001 6400 0000 fff6 0003 0001 0004 0000 0001"],
["17:39:11.537572","PFE proto 2 (ipv4): (tos 0xc0, ttl   1, id 27232, offset 0, flags [none], proto: OSPF (89), length: 80) 12.5.0.1 > 224.0.0.5: OSPFv2, Hello, length 60 [len 48]","0000 0002 45c0 0050 6a60 0000 0159 622a 0c05 0001 e000 0005 0201 0030 6400 0000 0000 0000 0204 0000 0000 0000 0000 0000 ffff ff00 000a 1280 0000 0028 0c05 0002 0c05 0001 6905 0505 fff6 0003 0001 0004 0000 0001"],
["17:39:11.737562","PFE proto 2 (ipv4): (tos 0xc0, ttl   1, id 27248, offset 0, flags [none], proto: OSPF (89), length: 80) 12.3.0.1 > 224.0.0.5: OSPFv2, Hello, length 60 [len 48]","0000 0002 45c0 0050 6a70 0000 0159 621c 0c03 0001 e000 0005 0201 0030 6400 0000 0000 0000 060c 0000 0000 0000 0000 0000 ffff ff00 000a 1280 0000 0028 0c03 0002 0c03 0001 6703 0303 fff6 0003 0001 0004 0000 0001"],
["17:39:13.725510","d8:b1:22:eb:75:0e > 01:00:5e:00:00:05, ethertype 802.1Q (0x8100), length 98: vlan 2, p 6, ethertype IPv4, (tos 0xc0, ttl   1, id 42978, offset 0, flags [none], proto: OSPF (89), length: 80) 12.2.0.2 > 224.0.0.5: OSPFv2, Hello, length 60 [len 48]","0100 5e00 0005 d8b1 22eb 750e 8100 c002 0800 45c0 0050 a7e2 0000 0159 24aa 0c02 0002 e000 0005 0201 0030 6602 0202 0000 0000 0810 0000 0000 0000 0000 0000 ffff ff00 000a 1280 0000 0028 0c02 0002 0c02 0001 6400 0000 fff6 0003 0001 0004 0000 0001"],
["17:17:38.831643","d8:b1:22:eb:75:0e > ff:ff:ff:ff:ff:ff, ethertype 802.1Q (0x8100), length 46: vlan 2, p 0, ethertype ARP, arp who-has 12.2.0.1 tell 12.2.0.2","ffff ffff ffff d8b1 22eb 750e 8100 0002 0806 0001 0800 0604 0001 d8b1 22eb 750e 0c02 0002 0000 0000 0000 0c02 0001"],
["17:17:38.832308","84:18:88:15:67:c0 > d8:b1:22:eb:75:0e, ethertype 802.1Q (0x8100), length 60: vlan 2, p 0, ethertype ARP, arp reply 12.2.0.1 is-at 84:18:88:15:67:c0","d8b1 22eb 750e 8418 8815 67c0 8100 0002 0806 0001 0800 0604 0002 8418 8815 67c0 0c02 0001 d8b1 22eb 750e 0c02 0002 0000 0000 0000 0000 0000 0000 0000"],
["17:39:14.381799","PFE proto 2 (ipv4): (tos 0xc0, ttl   1, id 27398, offset 0, flags [none], proto: OSPF (89), length: 80) 12.2.0.1 > 224.0.0.5: OSPFv2, Hello, length 60 [len 48]","0000 0002 45c0 0050 6b06 0000 0159 6187 0c02 0001 e000 0005 0201 0030 6400 0000 0000 0000 0810 0000 0000 0000 0000 0000 ffff ff00 000a 1280 0000 0028 0c02 0002 0c02 0001 6602 0202 fff6 0003 0001 0004 0000 0001"],
["17:17:38.818505","d8:b1:22:eb:75:0e > ff:ff:ff:ff:ff:ff, ethertype 802.1Q (0x8100), length 46: vlan 4, p 0, ethertype ARP, arp who-has 12.4.0.1 tell 12.4.0.2","ffff ffff ffff d8b1 22eb 750e 8100 0004 0806 0001 0800 0604 0001 d8b1 22eb 750e 0c04 0002 0000 0000 0000 0c04 0001"],
["17:17:38.819152","84:18:88:15:67:c0 > d8:b1:22:eb:75:0e, ethertype 802.1Q (0x8100), length 60: vlan 4, p 0, ethertype ARP, arp reply 12.4.0.1 is-at 84:18:88:15:67:c0","d8b1 22eb 750e 8418 8815 67c0 8100 0004 0806 0001 0800 0604 0002 8418 8815 67c0 0c04 0001 d8b1 22eb 750e 0c04 0002 0000 0000 0000 0000 0000 0000 0000"],
["17:17:38.822365","d8:b1:22:eb:75:0e > ff:ff:ff:ff:ff:ff, ethertype 802.1Q (0x8100), length 46: vlan 1, p 0, ethertype ARP, arp who-has 12.1.0.1 tell 12.1.0.2","ffff ffff ffff d8b1 22eb 750e 8100 0001 0806 0001 0800 0604 0001 d8b1 22eb 750e 0c01 0002 0000 0000 0000 0c01 0001"],
["17:39:14.890495","d8:b1:22:eb:75:0e > 01:00:5e:00:00:05, ethertype 802.1Q (0x8100), length 98: vlan 5, p 6, ethertype IPv4, (tos 0xc0, ttl   1, id 43014, offset 0, flags [none], proto: OSPF (89), length: 80) 12.5.0.2 > 224.0.0.5: OSPFv2, Hello, length 60 [len 48]"," 0100 5e00 0005 d8b1 22eb 750e 8100 c005 0800 45c0 0050 a806 0000 0159 2483 0c05 0002 e000 0005 0201 0030 6905 0505 0000 0000 0204 0000 0000 0000 0000 0000 ffff ff00 000a 1280 0000 0028 0c05 0002 0c05 0001 6400 0000 fff6 0003 0001 0004 0000 0001"],
["17:39:15.817490","PFE proto 2 (ipv4): (tos 0xc0, ttl   1, id 27476, offset 0, flags [none], proto: OSPF (89), length: 80) 12.1.0.1 > 224.0.0.5: OSPFv2, Hello, length 60 [len 48]","0000 0002 45c0 0050 6b54 0000 0159 613a 0c01 0001 e000 0005 0201 0030 6400 0000 0000 0000 0a14 0000 0000 0000 0000 0000 ffff ff00 000a 1280 0000 0028 0c01 0002 0c01 0001 6501 0101 fff6 0003 0001 0004 0000 0001"],
["17:17:38.823031","84:18:88:15:67:c0 > d8:b1:22:eb:75:0e, ethertype 802.1Q (0x8100), length 60: vlan 1, p 0, ethertype ARP, arp reply 12.1.0.1 is-at 84:18:88:15:67:c0","d8b1 22eb 750e 8418 8815 67c0 8100 0001 0806 0001 0800 0604 0002 8418 8815 67c0 0c01 0001 d8b1 22eb 750e 0c01 0002 0000 0000 0000 0000 0000 0000 0000"],
["17:17:38.827470","d8:b1:22:eb:75:0e > ff:ff:ff:ff:ff:ff, ethertype 802.1Q (0x8100), length 46: vlan 5, p 0, ethertype ARP, arp who-has 12.5.0.1 tell 12.5.0.2","ffff ffff ffff d8b1 22eb 750e 8100 0005 0806 0001 0800 0604 0001 d8b1 22eb 750e 0c05 0002 0000 0000 0000 0c05 0001"],
["17:17:38.828266","84:18:88:15:67:c0 > d8:b1:22:eb:75:0e, ethertype 802.1Q (0x8100), length 60: vlan 5, p 0, ethertype ARP, arp reply 12.5.0.1 is-at 84:18:88:15:67:c0","d8b1 22eb 750e 8418 8815 67c0 8100 0005 0806 0001 0800 0604 0002 8418 8815 67c0 0c05 0001 d8b1 22eb 750e 0c05 0002 0000 0000 0000 0000 0000 0000 0000"]]


ARPTbl =["MAC Address Address Name Interface Flags",
"00:00:5e:00:01:13 10.219.39.65 10.219.39.65 fxp0.0 none",
"84:18:88:15:67:c0 12.1.0.1 12.1.0.1 ae0.1 none",
"84:18:88:15:67:c0 12.2.0.1 12.2.0.1 ae0.2 none",
"84:18:88:15:67:c0 12.3.0.1 12.3.0.1 ae0.3 none",
"84:18:88:15:67:c0 12.4.0.1 12.4.0.1 ae0.4 none",
"84:18:88:15:67:c0 12.5.0.1 12.5.0.1 ae0.5 none",
"02:00:00:00:00:10 128.0.0.50 tfeb0 em0.0 none"]

ARPValidDict = {}
for pktData in MonIntfLst:
	if "arp reply" in pktData[1]:
		ARPRespMAC = pktData[2].split("0806")[1][20:35]
		ARPRespMAC = ARPRespMAC.replace(" ","")
		ARPRespIP = pktData[2].split("0806")[1][36:45]
		ARPRespIP = ARPRespIP.replace(" ","")
		IPStr = str(int(ARPRespIP[:2],16))+"."+str(int(ARPRespIP[2:4],16))+"."+str(int(ARPRespIP[4:6],16))+"."+str(int(ARPRespIP[6:8],16))
		MACStr = ARPRespMAC[:2]+":"+ARPRespMAC[2:4]+":"+ARPRespMAC[4:6]+":"+ARPRespMAC[6:8]+":"+ARPRespMAC[8:10]+":"+ARPRespMAC[10:12]
		for ARPTblRec in ARPTbl:
			if IPStr in ARPTblRec and MACStr in ARPTblRec:
				ARPValidDict[IPStr] = MACStr
				break
print(ARPValidDict)

'''
In the first list - Mon_Int_lst,look out for ARP reply packet among all the packet observed for the interface. 
From the ARP response packet find the sender MAC address and sender protocol address by decoding the "pkt content" inside the ARP response packet.
Check that IP in the second list - ARP_Table if present.
If present, then create a dictonary of {IP,MAC}
'''


'''
 0001 0800 0604 0002 8418 8815 67c0 0c03 0001 d8b1 22eb 750e 0c03 0002 0000 0000 0000 0000 0000 0000 0000
 0001 0800 0604 0002 8418 8815 67c0 0c02 0001 d8b1 22eb 750e 0c02 0002 0000 0000 0000 0000 0000 0000 0000
 0001 0800 0604 0002 8418 8815 67c0 0c04 0001 d8b1 22eb 750e 0c04 0002 0000 0000 0000 0000 0000 0000 0000
 0001 0800 0604 0002 8418 8815 67c0 0c01 0001 d8b1 22eb 750e 0c01 0002 0000 0000 0000 0000 0000 0000 0000
 0001 0800 0604 0002 8418 8815 67c0 0c05 0001 d8b1 22eb 750e 0c05 0002 0000 0000 0000 0000 0000 0000 0000


 {'12.3.0.1': '84:18:88:15:67:c0', '12.2.0.1': '84:18:88:15:67:c0', '12.4.0.1': '84:18:88:15:67:c0', '12.1.0.1': '84:18:88:15:67:c0', '12.5.0.1': '84:18:88:15:67:c0'}
'''